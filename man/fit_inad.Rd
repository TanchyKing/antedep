% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit_inad.R
\name{fit_inad}
\alias{fit_inad}
\title{Fit INAD model by maximum likelihood}
\usage{
fit_inad(
  y,
  order = 1,
  thinning = c("binom", "pois", "nbinom"),
  innovation = c("pois", "bell", "nbinom"),
  blocks = NULL,
  max_iter = 50,
  tol = 1e-06,
  verbose = FALSE,
  init_alpha = NULL,
  init_theta = NULL,
  init_tau = 0.4,
  init_nb_inno_size = 1
)
}
\arguments{
\item{y}{Integer matrix n_sub by n_time.}

\item{order}{Integer in \{0, 1, 2\}.}

\item{thinning}{One of "binom", "pois", "nbinom".}

\item{innovation}{One of "pois", "bell", "nbinom".}

\item{blocks}{Optional integer vector length n_sub. Default NULL.}

\item{max_iter}{Max iterations for FE coordinate descent.}

\item{tol}{Tolerance for FE log likelihood stopping.}

\item{verbose}{Logical.}

\item{init_alpha}{Optional initial alpha. For order 1 numeric length 1 or n_time.
For order 2 matrix n_time by 2 or list(alpha1, alpha2).}

\item{init_theta}{Optional initial theta numeric length 1 or n_time.}

\item{init_tau}{Optional initial tau. Scalar expands to c(0, x, ..., x). Vector forces first to 0.}

\item{init_nb_inno_size}{Optional initial size for innovation nbinom, length 1 or n_time.}
}
\value{
A list with estimators, log likelihood, and settings.
}
\description{
No fixed effect: time separable optimization using logL_inad_i with theta eliminated
by moment equations for order 1 and 2.
}
\details{
Fixed effect: block coordinate descent using nloptr BOBYQA, updating tau, alpha,
theta, and nb_inno_size if needed.
}
