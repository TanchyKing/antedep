% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/lrt_stationarity_cat.R
\name{lrt_stationarity_cat}
\alias{lrt_stationarity_cat}
\title{Likelihood ratio test for stationarity (categorical data)}
\usage{
lrt_stationarity_cat(
  y,
  order = 1,
  blocks = NULL,
  homogeneous = TRUE,
  n_categories = NULL
)
}
\arguments{
\item{y}{Integer matrix with n_subjects rows and n_time columns. Each entry
should be a category code from 1 to c.}

\item{order}{Antedependence order p. Default is 1.}

\item{blocks}{Optional integer vector of length n_subjects specifying group
membership.}

\item{homogeneous}{Logical. If TRUE (default), parameters are shared across
all groups.}

\item{n_categories}{Number of categories. If NULL, inferred from data.}
}
\value{
A list of class \code{"cat_lrt"} containing:
\item{lrt_stat}{Likelihood ratio test statistic}
\item{df}{Degrees of freedom}
\item{p_value}{P-value from chi-square distribution}
\item{fit_null}{Fitted stationary model (H0)}
\item{fit_alt}{Fitted non-stationary model (H1)}
\item{table}{Summary data frame}
}
\description{
Tests whether a categorical antedependence process is strictly stationary,
meaning both the marginal distribution and transition probabilities are
constant over time.
}
\details{
Strict stationarity requires:
\enumerate{
\item The marginal distribution P(Yk) is constant for all k
\item The transition probabilities P(Yk | Y(k-p), ..., Y(k-1)) are
constant for all k > p
}

This is stronger than time-invariance, which only requires condition 2.

The null hypothesis is tested against the general (non-stationary) AD(p)
model. The degrees of freedom are:
\deqn{df = (c-1)(n-1) + (c-1)c^p(n-p-1)}
for order p >= 1, which accounts for both marginal and transition constraints.
}
\examples{
\dontrun{
# Simulate stationary AD(1) data
set.seed(123)
y <- simulate_cat(200, 6, order = 1, n_categories = 2)

# Test stationarity
test <- lrt_stationarity_cat(y, order = 1)
print(test)
}

}
\references{
Xie, Y. and Zimmerman, D. L. (2013). Antedependence models for nonstationary
categorical longitudinal data with ignorable missingness: likelihood-based
inference. \emph{Statistics in Medicine}, 32, 3274-3289.
}
\seealso{
\code{\link{lrt_timeinvariance_cat}}, \code{\link{lrt_order_cat}}
}
